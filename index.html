<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="google-site-verification" content="1ggUqGHXC9icoyOtJNlbXpcSIwwtpW59CDgjiE0hxCc" />
    <meta charset="UTF-8">
    <meta name="description" content="Rise Avenue Studio - ‡§∏‡§∞‡§ï‡§æ‡§∞‡•Ä ‡§´‡•â‡§∞‡•ç‡§Æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§´‡•ã‡§ü‡•ã ‡§∞‡§ø‡§∏‡§æ‡§á‡§ú ‡§î‡§∞ ‡§∞‡•ã‡§ü‡•á‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡§æ ‡§¨‡•á‡§∏‡•ç‡§ü ‡§ü‡•Ç‡§≤‡•§">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rise Avenue | Photo Studio Pro</title>
    
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"></script>

    <style>
        /* ========================================= */
        /* THEME: RISE AVENUE PRO (ORIGINAL)         */
        /* ========================================= */
        :root {
            --brand-blue: #0f172a;       
            --brand-orange: #f97316;     
            --bg-light: #f1f5f9;
        }
        body { font-family: 'Segoe UI', sans-serif; margin: 0; background: var(--bg-light); color: var(--brand-blue); display: flex; flex-direction: column; min-height: 100vh; }

        header { background: linear-gradient(135deg, #ff512f, #dd2476); color: white; text-align: center; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
        header h1 { margin: 0; font-size: 2.2rem; text-transform: uppercase; letter-spacing: 1px; }
        
        .container { max-width: 1200px; margin: 20px auto; padding: 20px; flex: 1; width: 100%; box-sizing: border-box; }

        .upload-card {
            background: white; border: 3px dashed var(--brand-orange); padding: 30px;
            text-align: center; border-radius: 15px; cursor: pointer; transition: 0.3s;
            background: linear-gradient(to bottom, #fff, #fff7ed);
        }
        .upload-card:hover { transform: translateY(-3px); box-shadow: 0 10px 25px rgba(249,115,22,0.15); }

        .gallery-strip { display: flex; gap: 15px; overflow-x: auto; padding: 15px 5px; min-height: 110px; }
        .thumb-wrapper { position: relative; display: inline-block; animation: popIn 0.3s; }
        .thumb {
            min-width: 90px; height: 90px; border-radius: 10px; overflow: hidden;
            border: 3px solid transparent; cursor: pointer; box-shadow: 0 4px 6px rgba(0,0,0,0.1); background: white;
        }
        .thumb img { width: 100%; height: 100%; object-fit: cover; }
        .thumb.active { border-color: var(--brand-orange); transform: scale(1.05); }
        .delete-btn {
            position: absolute; top: -8px; right: -8px; background: #ef4444; color: white;
            border-radius: 50%; width: 22px; height: 22px; text-align: center; line-height: 20px;
            font-weight: bold; cursor: pointer; border: 2px solid white; z-index: 10;
        }

        #editor-workspace { display: none; background: white; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); margin-top: 20px; overflow: hidden; }
        .split-view { display: flex; flex-wrap: wrap; border-bottom: 2px solid #eee; }
        
        .view-box { flex: 1; padding: 20px; min-width: 320px; text-align: center; }
        .view-left { background: #f8fafc; border-right: 1px solid #ddd; }
        
        .img-wrapper { 
            height: 380px; display: flex; align-items: center; justify-content: center; 
            overflow: hidden; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAHUlEQVQ4jWNgYGAQIIAgj0YNBqMGDQajBg2AgwYA+a4CwhMi6CgAAAAASUVORK5CYII=');
        }
        .img-wrapper img { max-width: 100%; max-height: 100%; border: 1px solid #ccc; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        
        .badge { display: inline-block; padding: 5px 15px; border-radius: 20px; font-size: 12px; margin-top: 10px; color: white; font-weight: bold; }
        .bg-blue { background: var(--brand-blue); }
        .bg-green { background: #22c55e; }

        .settings-area { padding: 30px; background: #fff; }
        .controls-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px; }
        
        .control-group { background: #f8fafc; padding: 15px; border-radius: 10px; border: 1px solid #e2e8f0; }
        .control-group label { display: block; font-weight: bold; margin-bottom: 8px; font-size: 13px; color: var(--brand-blue); }
        input, select { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; font-weight: 600; }
        .flex-row { display: flex; gap: 5px; align-items: center; }

        .btn { width: 100%; padding: 12px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; color: white; transition:0.3s; }
        .btn-crop { background: #333; width: auto; padding: 8px 20px; margin-bottom:10px; } 
        .btn-check { background: linear-gradient(to right, #4facfe, #00f2fe); }
        .btn-down { background: linear-gradient(to right, #f97316, #ff512f); opacity: 0.5; pointer-events: none; }
        .btn-down.active { opacity: 1; pointer-events: all; }
        .btn:hover { transform: translateY(-2px); opacity: 0.9; }

        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 9999; flex-direction: column; justify-content: center; align-items: center; }
        .modal-box { background: white; padding: 30px; border-radius: 15px; width: 90%; max-width: 400px; text-align: center; }
        .crop-container { width: 80%; height: 70%; background: #000; margin-bottom: 20px; }
        .action-btns { display: flex; gap: 20px; margin-top:20px; justify-content:center; }
        .btn-modal { padding: 10px 30px; font-size: 16px; border-radius: 50px; cursor: pointer; border: none; font-weight: bold; }
        .btn-save { background: var(--brand-orange); color: white; }
        .btn-cancel { background: white; color: black; border:1px solid #ccc; }

        footer { margin-top: auto; padding: 20px; background: var(--brand-blue); color: white; text-align: center; border-top: 5px solid var(--brand-orange); font-size: 14px; }
        .footer-link { color: var(--brand-orange); text-decoration: none; font-weight: bold; margin-left: 10px; cursor: pointer; }

        .rotation-controls { margin-bottom: 15px; display: flex; gap: 10px; align-items: center; color: white; }
        
        @keyframes popIn { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }
    </style>
</head>
<body>

    <header>
        <h1>Rise Avenue Photo Studio</h1>
        <p>Edit, Resize & Rotate</p>
    </header>

    <main class="container">
        
        <div class="upload-card" onclick="document.getElementById('filesInput').click()">
            <input type="file" id="filesInput" hidden multiple accept="image/*">
            <span style="font-size:40px;">üìÇ</span>
            <h2>Select Photos</h2>
            <p>Support: All Formats</p>
        </div>

        <div class="gallery-strip" id="gallery"></div>

        <div id="editor-workspace">
            <div class="split-view">
                <div class="view-box view-left">
                    <h3>Original Image</h3>
                    <div class="img-wrapper"><img id="imgOrg" src="" alt="Original"></div>
                    <button class="btn btn-crop" onclick="openCropper()">‚úÇÔ∏è Manual Crop & Rotate</button>
                    <div id="infoOrg" class="badge bg-blue">Upload Image</div>
                </div>
                <div class="view-box view-right">
                    <h3>Final Result</h3>
                    <div class="img-wrapper"><img id="imgNew" src="" style="opacity:0.5;" alt="Final Result"></div>
                    <div id="infoNew" class="badge bg-green" style="background:#64748b;">Click Apply</div>
                </div>
            </div>

            <div class="settings-area">
                <div class="controls-grid">
                    
                    <div class="control-group">
                        <label>1. Target Size & Resize:</label>
                        <div class="flex-row">
                            <input type="number" id="kbVal" value="50" placeholder="KB">
                            <select id="kbUnit" style="width:70px;"><option>KB</option><option>MB</option></select>
                        </div>
                        <div class="flex-row" style="margin-top:10px;">
                            <input type="number" id="wVal" placeholder="W" aria-label="Width"> <span>:</span> <input type="number" id="hVal" placeholder="H" aria-label="Height">
                        </div>
                    </div>

                    <div class="control-group">
                        <label>2. DPI (Resolution):</label>
                        <input type="number" id="dpiVal" value="96" placeholder="96">
                    </div>

                    <div class="control-group">
                        <label>3. Save Extension As:</label>
                        <select id="extList">
                            <optgroup label="Default">
                                <option value="original">Original Format</option>
                            </optgroup>
                            <optgroup label="JPEG Family">
                                <option value="jpg">.jpg</option>
                                <option value="jpeg">.jpeg</option>
                                <option value="jfif">.jfif</option>
                                <option value="pjpeg">.pjpeg</option>
                                <option value="pjp">.pjp</option>
                            </optgroup>
                            <optgroup label="Standard Images">
                                <option value="png">.png</option>
                                <option value="gif">.gif</option>
                                <option value="webp">.webp</option>
                                <option value="bmp">.bmp</option>
                                <option value="tiff">.tiff</option>
                            </optgroup>
                            <optgroup label="Vector & Documents">
                                <option value="pdf">.pdf</option>
                            </optgroup>
                        </select>
                    </div>
                </div>

                <div style="display:flex; gap:15px; margin-top:20px;">
                    <button class="btn btn-check" onclick="applyChanges()">‚ôªÔ∏è Apply & Check</button>
                    <button id="dlBtn" class="btn btn-down" onclick="downloadImage()">‚¨áÔ∏è Download</button>
                </div>
                <p id="status" style="text-align:center; font-weight:bold; margin-top:10px; color:#333;"></p>
            </div>
        </div>
    </main>

    <div id="crop-modal" class="modal">
        <div class="crop-container"><img id="crop-image" src="" alt="Cropper"></div>
        <div class="rotation-controls">
            <span>Fine Rotate: </span>
            <input type="range" id="rotate-slider" min="-180" max="180" value="0" style="width:200px;" oninput="doRotate(this.value)">
            <span id="rotate-val">0¬∞</span>
        </div>
        <div class="action-btns">
            <button class="btn-modal btn-cancel" onclick="closeCropper()">Cancel</button>
            <button class="btn-modal btn-save" onclick="saveCrop()">‚úÖ Save</button>
        </div>
    </div>

    <div id="feedback-modal" class="modal" style="background:rgba(0,0,0,0.8);">
        <div class="modal-box">
            <h2 style="color:var(--brand-blue); margin-top:0;">üì© Feedback</h2>
            <input type="text" id="f-name" placeholder="Your Name" style="margin-bottom:10px;">
            <textarea id="f-msg" rows="4" placeholder="Describe issue or suggestion..." style="width:100%; padding:10px; border:1px solid #ccc; border-radius:5px; margin-bottom:10px;"></textarea>
            <div class="action-btns">
                <button class="btn-modal btn-cancel" onclick="document.getElementById('feedback-modal').style.display='none'">Close</button>
                <button class="btn-modal btn-save" onclick="alert('Thank you! Feedback Sent.'); document.getElementById('feedback-modal').style.display='none'">Send</button>
            </div>
        </div>
    </div>

    <footer>
        2026 ¬© Rise Avenue Studio - Secure & Professional
        <span class="footer-link" onclick="document.getElementById('feedback-modal').style.display='flex'">üì© Give Feedback</span>
    </footer>

    <script>
        let files = [];
        let activeIdx = 0;
        let processedBlob = null;
        let cropper = null;
        let currentImgSrc = "";

        // 1. Upload
        document.getElementById('filesInput').addEventListener('change', (e) => {
            const f = Array.from(e.target.files);
            if(f.length > 10) { alert("Max 10 files!"); return; }
            files = files.concat(f).slice(0, 10);
            renderGallery();
            if(files.length > 0) loadFile(files.length - f.length);
        });

        // 2. Gallery
        function renderGallery() {
            const gal = document.getElementById('gallery');
            gal.innerHTML = "";
            if(files.length === 0) { document.getElementById('editor-workspace').style.display = 'none'; return; }
            files.forEach((f, i) => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    gal.innerHTML += `<div class="thumb-wrapper"><div class="thumb ${i===activeIdx?'active':''}" id="t${i}" onclick="loadFile(${i})"><img src="${e.target.result}" alt="Thumb"></div><span class="delete-btn" onclick="removeFile(event, ${i})">√ó</span></div>`;
                };
                reader.readAsDataURL(f);
            });
            document.getElementById('editor-workspace').style.display = 'block';
        }

        function removeFile(e, i) {
            e.stopPropagation(); files.splice(i, 1);
            if(files.length === 0) activeIdx = 0; else if(i <= activeIdx) activeIdx = Math.max(0, activeIdx-1);
            renderGallery(); if(files.length>0) loadFile(activeIdx);
        }

        function loadFile(i) {
            activeIdx = i;
            document.querySelectorAll('.thumb').forEach(t => t.classList.remove('active'));
            if(document.getElementById(`t${i}`)) document.getElementById(`t${i}`).classList.add('active');
            
            const file = files[i];
            const reader = new FileReader();
            reader.onload = (e) => {
                const img = new Image();
                img.src = e.target.result;
                img.onload = () => {
                    document.getElementById('infoOrg').innerText = `Size: ${(file.size/1024).toFixed(1)} KB | ${img.width}x${img.height} px`;
                };
                currentImgSrc = e.target.result;
                document.getElementById('imgOrg').src = currentImgSrc;
                resetPreview();
            };
            reader.readAsDataURL(file);
        }

        function resetPreview() {
            document.getElementById('imgNew').src = ""; 
            document.getElementById('imgNew').style.opacity = "0.5";
            document.getElementById('infoNew').innerText = "Click Apply"; 
            document.getElementById('infoNew').style.background = "#64748b";
            document.getElementById('dlBtn').classList.remove('active');
            document.getElementById('status').innerText = "";
        }

        // 3. Cropper & Rotation
        function openCropper() {
            document.getElementById('crop-modal').style.display = "flex";
            const img = document.getElementById('crop-image');
            img.src = currentImgSrc;
            document.getElementById('rotate-slider').value = 0;
            document.getElementById('rotate-val').innerText = "0¬∞";
            if(cropper) cropper.destroy();
            cropper = new Cropper(img, { viewMode:1, autoCropArea:0.8 });
        }
        function doRotate(val) {
            if(cropper) {
                cropper.rotateTo(val);
                document.getElementById('rotate-val').innerText = val + "¬∞";
            }
        }
        function closeCropper() { document.getElementById('crop-modal').style.display = "none"; }
        function saveCrop() {
            if(!cropper) return;
            currentImgSrc = cropper.getCroppedCanvas().toDataURL('image/jpeg', 0.9);
            document.getElementById('imgOrg').src = currentImgSrc;
            closeCropper(); resetPreview();
        }

        // 4. MAIN ENGINE
        function applyChanges() {
            const status = document.getElementById('status'); status.innerText = "Processing...";
            const img = new Image(); img.src = currentImgSrc;
            
            img.onload = () => {
                const canvas = document.createElement('canvas'); const ctx = canvas.getContext('2d');
                let w = document.getElementById('wVal').value || img.width;
                let h = document.getElementById('hVal').value || img.height;
                canvas.width = w; canvas.height = h;
                ctx.drawImage(img, 0, 0, w, h);

                const extVal = document.getElementById('extList').value;
                let mime = "image/jpeg";
                if(extVal === "png") mime = "image/png";
                if(extVal === "webp") mime = "image/webp";

                if(extVal === 'pdf') {
                    const { jsPDF } = window.jspdf; const doc = new jsPDF();
                    const imgD = canvas.toDataURL('image/jpeg', 0.95);
                    doc.addImage(imgD, 'JPEG', 10, 10, 190, 0);
                    processedBlob = doc.output('blob');
                    updatePreview(imgD, "PDF Ready", (processedBlob.size/1024).toFixed(2)); return;
                }

                let targetKB = document.getElementById('kbVal').value;
                if(document.getElementById('kbUnit').value === 'MB') targetKB *= 1024;

                let q = 1.0; let dataUrl = "";
                // COMMAND FIX: 20 KB ‡§ï‡•á ‡§≤‡§ø‡§è q <= 0.01 ‡§§‡§ï ‡§ú‡§æ‡§è‡§ó‡§æ
                const loop = setInterval(() => {
                    dataUrl = canvas.toDataURL(mime, q);
                    const size = (dataUrl.length * 3/4) / 1024;
                    if(size <= targetKB || q <= 0.01) {
                        clearInterval(loop); processedBlob = dataUrl;
                        updatePreview(dataUrl, `Final: ${size.toFixed(2)} KB`, size.toFixed(2));
                    } else { q -= 0.02; }
                }, 10);
            };
        }

        function updatePreview(src, txt, size) {
            document.getElementById('imgNew').src = src; document.getElementById('imgNew').style.opacity = "1";
            document.getElementById('infoNew').innerText = txt; 
            document.getElementById('infoNew').style.background = "#22c55e";
            document.getElementById('status').innerText = "Success! Click Download.";
            document.getElementById('dlBtn').innerText = `‚¨áÔ∏è Download (${size} KB)`; document.getElementById('dlBtn').classList.add('active');
        }

        function downloadImage() {
            if(!processedBlob) return;
            const file = files[activeIdx];
            let ext = document.getElementById('extList').value;
            if(ext === 'original') {
                const parts = file.name.split('.');
                ext = parts[parts.length-1];
            }
            const link = document.createElement('a');
            if(ext === 'pdf') link.href = URL.createObjectURL(processedBlob); else link.href = processedBlob;
            link.download = `RiseAvenue_${Date.now()}.${ext}`; link.click();
        }
    </script>
</body>
</html>
